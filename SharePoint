


Connect-SPOService -Url https://aegide-admin.sharepoint.com

Connect-SPOService -Url https://aegide-admin.sharepoint.com
PS C:\Users\jacob.diakite-ext> Get-SPOTenant | Select OrphanedPersonalSitesRetentionPeriod



Restore-MgUser -UserId user@domain.com


Get-SPODeletedSite | Where-Object {$_.Url -like "*aegide-my.sharepoint.com/personal/*"}


 Get-SPODeletedSite -IncludeOnlyPersonalSite | Format-Table Url

Get-SPODeletedSite -IncludeOnlyPersonalSite | Format-Table Url, DeletionTime

Get-SPODeletedSite -IncludeOnlyPersonalSite | Where-Object {$_.Url -like "*maintenance*"}| Format-Table Url, DeletionTime


 Get-SPODeletedSite -IncludeOnlyPersonalSite | Where-Object {$_.Url -like "*maintenance*"}| Format-Table Url, DeletionTime

AVERTISSEMENT : More results were found but were not returned.  Use '-Limit ALL' to return all possible results.




 Get-SPODeletedSite | Select Url, DeletionTime, StorageQuota

Url                                                                                                                     DeletionTime        StorageQuota
---                                                                                                                     ------------        ------------
https://aegide.sharepoint.com/sites/Teams-BPACKDTG10                                                                    21/08/2025 09:53:15     26214400
https://aegide.sharepoint.com/sites/Teams-TEST_fcczkr                                                                   17/10/2025 13:06:11     26214400
https://aegide.sharepoint.com/sites/Teams-Comitditorial                                                                 08/08/2025 07:36:42     26214400


PowerShell
Get-SPOSite -IncludePersonalSite $true -Limit All -Template "SPSPERS" | ForEach-Object {
  $primary = $_.Owner
  $secondary = ""
  $errorMessage = ""
  try {  
    $admins = Get-SPOUser -Site $_.Url 2>$null  
    $secondary = ($admins | Where-Object { $_.IsSiteAdmin -eq $true -and $_.LoginName -ne $primary } | Select-Object -ExpandProperty LoginName) -join ";"  
  } catch {  
    $errorMessage = $_.Exception.Message  
  }
  [PSCustomObject]@{  
    "OneDrive URL"                   = $_.Url   
    "Primary Site Collection Admin"  = $primary   
    "Secondary Site Collection Admins" = if ($secondary) { $secondary } else { "Error in retrieval" } 
    "Error Message"                  = $errorMessage   
  }  
} | Export-Csv -Path "<OutputCSVFilePath>" -NoTypeInformation -Encoding UTF8

https://aegide.sharepoint.com/sites/DAF                    
